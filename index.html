<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
  background:#eee;
  padding:20px;
  font-family:'Inter', Arial, sans-serif;
}

/* Exact A4 canvas */
.canvas{
  position:relative;
  width:794px;   /* A4 @ 96dpi */
  height:1123px;
  margin:auto;
  background:#fff;
}

/* PDF background */
.bg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:0;
}

/* Overlay layer */
.layer{
  position:absolute;
  inset:0;
  z-index:1;
}

/* Editable text */
.field{
  position:absolute;
  font-size:12px;
  line-height:16px;
}

input{
  border:none;
  background:transparent;
  font-family:inherit;
  font-size:12px;
  width:100%;
}

/* Items table */
.items{
  position:absolute;
  left:90px;
  top:360px;
  width:610px;
  border-collapse:collapse;
  font-size:12px;
}

.items td{
  padding:6px 4px;
}

.items .amt{
  text-align:right;
}

/* + icon */
.add{
  position:absolute;
  top:340px;
  left:90px;
  font-weight:600;
  cursor:pointer;
}

/* Totals */
.total{
  position:absolute;
  right:90px;
  top:510px;
  text-align:right;
  font-size:12px;
}

/* Words */
.words{
  position:absolute;
  left:90px;
  top:560px;
  font-size:12px;
  font-weight:500;
}

/* Buttons */
.actions{
  text-align:center;
  margin-top:20px;
}

/* Hide UI in PDF */
@media print{
  .actions, .add{ display:none; }
}
</style>
</head>

<body>

<div class="canvas" id="invoice">

  <!-- Background PDF image -->
  <img src="template.png" class="bg">

  <!-- Editable overlay -->
  <div class="layer">

    <!-- Bill To -->
    <div class="field" style="left:90px; top:150px;">
      Thefseer Abdul Sathar<br>
      Dubai U.A.E<br>
      971567169979<br>
      thefseernk@gmail.com
    </div>

    <!-- Invoice meta -->
    <div class="field" style="right:90px; top:150px; text-align:right;">
      TEF-INV-2026-01-001<br>
      2026-01-30<br>
      2026-02-06
    </div>

    <!-- Add item -->
    <div class="add" onclick="addRow()">+</div>

    <!-- Items -->
    <table class="items" id="items">
      <tbody>
        <tr>
          <td width="60%">
            <input value="Charges for Light Feature Visual">
          </td>
          <td width="10%">
            <input type="number" value="3" oninput="calc()">
          </td>
          <td width="15%">
            <input type="number" value="500" oninput="calc()">
          </td>
          <td width="15%" class="amt amount">1,500.00</td>
        </tr>
      </tbody>
    </table>

    <!-- Totals -->
    <div class="total">
      <div>Total: <span id="total">1,500.00</span></div>
      <div>Paid: <input type="number" value="0" oninput="calc()" style="width:80px;text-align:right"></div>
      <div><strong>Balance Due:</strong> <span id="balance">1,500.00</span></div>
    </div>

    <!-- Words -->
    <div class="words" id="words">
      One Thousand Five Hundred AED Only
    </div>

  </div>
</div>

<div class="actions">
  <button onclick="generatePDF()">Generate PDF</button>
</div>

<script>
function calc(){
  let total=0;
  document.querySelectorAll("#items tr").forEach(r=>{
    let q=+r.children[1].children[0].value||0;
    let rate=+r.children[2].children[0].value||0;
    let amt=q*rate;
    r.querySelector(".amount").innerText=
      amt.toLocaleString(undefined,{minimumFractionDigits:2});
    total+=amt;
  });
  let paid=document.querySelector(".total input").value||0;
  let bal=total-paid;
  document.getElementById("total").innerText=
    total.toLocaleString(undefined,{minimumFractionDigits:2});
  document.getElementById("balance").innerText=
    bal.toLocaleString(undefined,{minimumFractionDigits:2});
  document.getElementById("words").innerText=
    numberToWords(bal)+" AED Only";
}

function addRow(){
  let tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input></td>
    <td><input type="number" value="1" oninput="calc()"></td>
    <td><input type="number" value="0" oninput="calc()"></td>
    <td class="amt amount">0.00</td>`;
  document.querySelector("#items tbody").appendChild(tr);
}

function numberToWords(n){
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  if(n===0)return"Zero";
  if(n<20)return a[n];
  if(n<100)return b[Math.floor(n/10)]+" "+a[n%10];
  if(n<1000)return a[Math.floor(n/100)]+" Hundred "+numberToWords(n%100);
  if(n<1000000)return numberToWords(Math.floor(n/1000))+" Thousand "+numberToWords(n%1000);
  return "";
}

async function generatePDF(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF("p","pt","a4");
  const canvas=await html2canvas(document.getElementById("invoice"),{scale:2});
  const img=canvas.toDataURL("image/png");
  pdf.addImage(img,"PNG",0,0,595,842);
  pdf.save("invoice.pdf");
}

calc();
</script>

</body>
</html>