<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
  font-family: Calibri, Arial, sans-serif;
  background:#eee;
  padding:20px;
}
.page{
  width:210mm;
  min-height:297mm;
  background:#fff;
  margin:auto;
  padding:20mm;
  box-sizing:border-box;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
}
.logo{
  max-height:60px;
}
h1{
  margin:0;
  font-size:26px;
  letter-spacing:1px;
}
.small{
  font-size:12px;
  line-height:1.5;
}
.section{ margin-top:18px; }

table{
  width:100%;
  border-collapse:collapse;
  margin-top:16px;
  font-size:13px;
}
th,td{
  border-bottom:1px solid #ccc;
  padding:6px;
  text-align:right;
}
th:first-child, td:first-child{ text-align:left; }

input{
  width:100%;
  border:none;
  font-family:inherit;
  font-size:13px;
  background:transparent;
  text-align:right;
}
.desc{ text-align:left; }

.totals{
  margin-top:16px;
}
.totals td{ padding:6px; }

.bold{ font-weight:bold; }

.bank{
  margin-top:22px;
  font-size:12px;
  line-height:1.5;
}

.actions{
  text-align:center;
  margin-top:20px;
}
button{
  padding:8px 14px;
  font-size:13px;
  cursor:pointer;
}

@media print{
  .actions{ display:none; }
}
</style>
</head>

<body>

<div class="page" id="invoice">

  <div class="header">
    <div>
      <h1>INVOICE</h1>
    </div>
    <img src="logo.png" class="logo" alt="">
  </div>

  <div class="section small" style="display:flex;justify-content:space-between">
    <div>
      <strong>Bill To :</strong><br>
      Thefseer Abdul Sathar<br>
      Dubai U.A.E<br>
      971567169979<br>
      thefseernk@gmail.com
    </div>
    <div style="text-align:right">
      Invoice No : <span id="invNo"></span><br>
      Invoice Date : <input type="date" value="2026-01-30"><br>
      Due Date : <input type="date" value="2026-02-06">
    </div>
  </div>

  <div class="section small">
    <strong>Project :</strong> Mubadala<br>
    <strong>Subject :</strong> Reception Light Feature
  </div>

  <table id="items">
    <thead>
      <tr>
        <th># Item & Description</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input class="desc" value="Charges for Light Feature Visual"></td>
        <td><input type="number" value="3" oninput="calc()"></td>
        <td><input type="number" value="500" oninput="calc()"></td>
        <td class="amount">1500.00</td>
      </tr>
    </tbody>
  </table>

  <table class="totals">
    <tr class="bold">
      <td>Total</td>
      <td id="total">1500.00</td>
    </tr>
    <tr>
      <td>Paid</td>
      <td><input type="number" value="0" oninput="calc()"></td>
    </tr>
    <tr class="bold">
      <td>Balance Due</td>
      <td id="balance">د.إ. 1,500.00</td>
    </tr>
  </table>

  <div class="small bold" id="words"></div>

  <div class="bank">
    <strong>Bank Details :</strong><br>
    Name: Thefseer Nalam Kuttiyil<br>
    Account No: 0215085399101<br>
    IBAN: AE410260000215085399101<br>
    Bank Name: Emirates NBD<br>
    Account Type: Savings Account
  </div>

</div>

<div class="actions">
  <button onclick="addRow()">Add Item</button>
  <button onclick="generatePDF()">Generate PDF (A4)</button>
</div>

<script>
/* Auto invoice number */
let last = localStorage.getItem("inv") || 1;
document.getElementById("invNo").innerText =
  "TEF-INV-2026-01-" + String(last).padStart(3,"0");
localStorage.setItem("inv", Number(last)+1);

function calc(){
  let total = 0;
  document.querySelectorAll("#items tbody tr").forEach(r=>{
    let q = +r.children[1].children[0].value || 0;
    let rate = +r.children[2].children[0].value || 0;
    let amt = q*rate;
    r.querySelector(".amount").innerText = amt.toFixed(2);
    total += amt;
  });
  let paid = document.querySelector(".totals input").value || 0;
  let bal = total - paid;

  document.getElementById("total").innerText = total.toFixed(2);
  document.getElementById("balance").innerText =
    "د.إ. " + bal.toLocaleString(undefined,{minimumFractionDigits:2});
  document.getElementById("words").innerText =
    numberToWords(bal) + " AED Only";
}

function addRow(){
  let tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input class="desc"></td>
    <td><input type="number" value="1" oninput="calc()"></td>
    <td><input type="number" value="0" oninput="calc()"></td>
    <td class="amount">0.00</td>`;
  document.querySelector("#items tbody").appendChild(tr);
}

function numberToWords(n){
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  if(n===0) return "Zero";
  if(n<20) return a[n];
  if(n<100) return b[Math.floor(n/10)]+" "+a[n%10];
  if(n<1000) return a[Math.floor(n/100)]+" Hundred "+numberToWords(n%100);
  if(n<1000000) return numberToWords(Math.floor(n/1000))+" Thousand "+numberToWords(n%1000);
  return "";
}

async function generatePDF(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF("p","mm","a4");
  const canvas=await html2canvas(document.getElementById("invoice"),{scale:2});
  const img=canvas.toDataURL("image/png");
  pdf.addImage(img,"PNG",0,0,210,canvas.height*210/canvas.width);
  pdf.save("invoice.pdf");
}

calc();
</script>

</body>
</html>
